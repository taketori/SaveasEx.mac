                                 SaveasEx.mac
                         「名前を付けて保存」拡張マクロ
                             秀丸 Ver.8 (以上) 専用版

　これは、SaveasEx.macのreadmeファイル<README.txt>です。

1. 概要説明
1-1. SaveasEx.macってなに？
 　秀丸エディッタ用のマクロです。
 　ファイルに記載されたファイル名と思わしき文字列を利用してファイル名を変更します。
 　秀丸の「ファイル名の変更」では、ファイル名候補としてファイル1行目の文字列が表示されますが、その機能をもう少しインテリジェントにしたものです。

1-2. だれとく？
 　ファイルの先頭にファイル名を書いたり、ファイルの先頭をファイル名にすることが多いような場合には役に立てると思います。
 　「ファイル名変更」や「名前をつけて保存」するときに、ダイアログからフォルダを選択するよりも手入力でフルパスを指定していることが多い場合などで便利に使えると思います。
 　なお、自称初心者の方の使用はお勧めしていません。

1-3. で、具体的な機能は？
 　起動すると、現在編集中のファイルからファイル名と思わしき文字列を検索し、ファイル名を変更します。
 　秀丸の「ファイル名の変更」とは違い、ファイル名に使える文字であれば、記号や空白なども利用しますし、保存フォルダを現在のフォルダからの相対で指定するということもできます。\ バックスラッシュの代わりに / スラッシュを利用することもできます。

1-3-1. ファイル名と思わしき文字列って何？
 　"ファイル名と思わしき文字列"は、ファイル先頭から5行(初期設定)以内にある、ファイルタイプ別設定の「ファイル名と思わしき場所」に該当する文字列です。
 　ただし、"ファイル名と思わしき文字列"を検索するときには、(初期設定では)shebangらしき行を無視します。
 　さらに「複数行コメント」を設定している場合は、コメントの中から優先的に探します。

1-3-2. shebangらしき行って？
 　ファイルの1行目1文字目から( #! といったように)半角記号とその直後の半角 ! エクスクラメーションマークで始まっている行があれば、その行のことです。
 　ここには、「!# Ruby.exe 〜」といった内容が記載されることが多いと思いますが、この部分を利用してファイル名を変更するといろいろとまずいことになるので、本マクロではなるべくこの部分を無視するようになっています。
 　また、前述のように、本マクロでは改名に利用する"ファイル名と思わしき文字列"をコメント部分から優先して探すのですが、2行目以降が「! 直前の半角記号」と同じ文字列で始まっていたら、たとえコメント部分でなくてもコメントと見なし、(そこにファイル名と思わしき文字列があれば)その部分をさらに優先して利用します。
 　この機能は、たとえば新規作成("ファイルタイプ別設定"が「共通」で、"複数行コメント"が「自動判定」や「なし」)...のような、コメントと見なされる部分が変更されやすい時に便利です。
 　大切なことなので2回いいますが、! 直前の文字列と同じ文字列で始まっている論理行だけです。

1-3-3. 保存フォルダはだいたい同じである。長いフォルダ名をタイプするのは面倒だ。
 　秀丸と同じフォルダ(変更可)に「mount.info」というファイルを作ってください。
 　このファイルにて適切に設定することで、たとえば "/sharedoc" を "C:\Documents and Settings\All Users\Documents" と見なすようにすることもできます。
 　また、初期設定では ~ チルダはマイドキュメントを意味するようになっていますので、"~\A.txt"と書いておけば、マイドキュメントに"A.txt"というファイル名で保存することが簡単にできます。
 　後述する<5. インストールとバージョンアップ、アンインストール>もご覧ください。

1-3-4. 「ファイル名と思わしき場所」に該当しないところをファイル名に使いたい。
 ・範囲選択されていたらその1行目
 ・「ファイル名と思わしき場所」と同じ文字色・背景色・スタイルでマークされたカラーマーカー部分があればその文字列
 をファイル名と思わしき文字列として最優先で利用します。

1-3-5. 「ファイル名と思わしき場所」をカラー表示していないけど、大丈夫？
 　「ファイル名と思わしき場所」を設定していない場合は、ファイルタイプ別設定の「ファイル名のカスタマイズ」の設定値や本マクロで別途定義した正規表現に該当するものを利用することもできます。
 　どれも該当しなければ、shebang行でないもっともファイル先頭側の行の、ファイル名に使える部分を利用します

1-4. ファイル名を変更するだけ？
 　そのほか、改名後のファイル名(フルパス)と"ファイル名と思わしき文字列"とを比較して、同義の場合は記載部分を削除することもできます。
 　作者は、この機能を利用して"ファイル名と思わしき文字列"のフォルダ部分を削除しています。

1-4-1. 秀丸の「ファイル名変更」では、「実際のファイルのファイル名も変更する」ことができるようだが？
 　もちろんできます。変更しないようにもできます。
 　なお、変更した後に変更前のファイルが変更前のフォルダに残りますが、仕様です。

1-4-2. それ以外の機能は？
 　もしも保存先のフォルダが存在しない場合は、マクロが作ります。もちろん、同じファイル名のファイルがあるか確認します。
 　それ以外にも、なるべく細かく問い合わせするように設計しています。

1-5. できそうでできない機能は何？
 　複数範囲選択時に選択範囲の2行目以降を利用することや、矩形選択時に選択範囲を利用することができません。
 　それ以外にもあるかもしれません。

1-6. 雑多なこと
1-6-1. 名前の由来は？
 　WindowsAPIみたいに、「名前をつけて保存(秀丸マクロでは"saveas")」機能よりちょっとは機能が拡張されたので、Exをつけてみました。

1-6-2. どこで手に入れることができるの？どこから手に入れたっけ？
 　後述する<2. 配布場所>をご覧ください。

1-6-3. 誰が作っているの？誰に連絡したらいいの？
 　後述する<6. コンタクト、サポート>をご覧ください。
 　なお、作者の知識の粋を尽くして作っているため、それ以上の事態になったら、サポートが十分にできない可能性があります。また、そのため、自称初心者の方の使用はお勧めしていません。

1-6-4. 私の環境でも使えますか？
 　後述する<4. 必要なもの>をご覧ください。<7. 謝辞、免責、ライセンス>もお読みください。

1-6-5. インストールやアンインストール、バージョンアップの方法は？
 　後述する<5. インストールとバージョンアップ、アンインストール>をご覧ください。

1-6-6. 使い方や設定方法は？
 　配布ファイルに同梱されている<SaveasEx.mac.txt>をご覧ください。

1-6-7. 改版履歴をみたいです。
 　どうしてもみたいのなら、配布ファイルに同梱されている<SaveasEx.mac.history.txt>をご覧ください。
 　詳細な改版履歴を確認したい場合は、後述する<2. 配布場所>に記載のgithubサイトでgitレポジトリも公開しています。


2. 配布場所

 　以下のURLからダウンロードできます。
http://hide.maruo.co.jp/lib/macro/dispkeyfunc.html
 　見つからない場合は、以下のURLから「dispkeyfunc」などで検索してみてください。
http://hide.maruo.co.jp/lib/macro/index.html

 　また、以下のURLからもダウンロードできます。「download」ボタンをクリックして、"ZIP"を選択してください。
http://github.com/taketori/SaveasEx.mac/downloads
 　gitのリポジトリも公開しています。


3. 配布ファイルに同梱されているもの

 SaveasEx.mac :             以下、「マクロ本体」
 README.txt :              「README」。このファイルです。
 SaveasEx.mac.txt :        「マニュアル」。使い方や設定方法を記載しています。
 SaveasEx.mac.history.txt :「改版履歴」


4. 必要なもの

 　以下のような環境が必要です。他にもあるかもしれませんが、一般的なユーザなら多分大丈夫でしょう。

 ・秀丸エディッタ Ver 8以上が動作する。
 ・COM・秀丸エディッタ同梱のDLLなどの呼び出し・実行できる権限がある。
 ・マクロ本体が存在するフォルダ及びそこに存在するファイルに対して、読み取り・実行・書き込みなどができる権限がある。

 ・mount.infoが、マクロ(というか秀丸エディッタ）から読み出すことができる権限がある。


5. インストールとバージョンアップ、アンインストール

 ・他の秀丸エディッタ用のマクロと同様です。
 　配布ファイルに含まれる全てのファイルを、同じフォルダに展開してください。
 ・mount.infoを必要に応じて作ってください。
 ・使い方、設定方法は、同梱のマニュアル<SaveasEx.mac.txt>をご覧ください。


6. コンタクト、サポート

6-1. 不具合報告及び要望などでの連絡先

 　メールや掲示板でお問い合わせの際は、本マクロについてであることがわかるように、題名にマクロ名を併記してください。

 ・メール
   src＠x10d.jp (@を半角に変更してから送信してください。)

 ・掲示板: コミュニテックス「4. 公開マクロ サポート会議室（秀丸エディタ関連）」
   http://www.maruo.co.jp/turukame/4/index.html

 ・githubのレポジトリ
   http://github.com/taketori/SaveasEx.mac/
   Issuesもどうぞ。

6-2. それ以外の内容で作者に連絡を取りたい場合は、以下の方法で。

 ・メール
   taketori＠x10d.jp (@を半角に変更してから送信してください。)


7. 謝辞、免責、ライセンス

 　特に以下の皆様に感謝申し上げます。
 ・秀丸及びその関連DLL、及び幾多の便利なマクロを作成し公開されている作者の皆様。
 ・Windowsや秀丸のマクロ、WSHについて調査し、情報をまとめ、公開されている皆様。
 ・このマクロをお使いいただき、フィードバックしていただいた皆様。

 　作者の知識の粋を尽くして作っているため、それ以上の事態になったら、サポートが十分にできない可能性があります。また、そのため、自称初心者の方の使用はお勧めしていません。
 　このマクロに関する一切の不都合について、作者はその責を負いません。
 　詳細は、事項を参照してください。

7-1. 免責、ライセンス条項

 著作権は、私 "たけとり"、"taketori"、及び "x10d.jp" が2009年から保有しています。
 ライセンスは、いわゆる「修正BSD」です。

 Copyright (c) 2009, たけとり
 All rights reserved.
 ソースコード形式かバイナリ形式か、変更するかしないかを問わず、以下の条件を満たす場合に限り、再頒布および使用が許可されます。

 ソースコードを再頒布する場合、上記の著作権表示、本条件一覧、および下記免責条項を含めること。
 バイナリ形式で再頒布する場合、頒布物に付属のドキュメント等の資料に、上記の著作権表示、本条件一覧、および下記免責条項を含めること。
 書面による特別の許可なしに、本ソフトウェアから派生した製品の宣伝または販売促進に、たけとり及びtaketori、並びにx10d、x10d.jp、及びエクステンド、エクステンド・ジャパンの名前またはコントリビューターの名前を使用してはならない。
 本ソフトウェアは、著作権者およびコントリビューターによって「現状のまま」提供されており、明示黙示を問わず、商業的な使用可能性、および特定の目的に対する適合性に関する暗黙の保証も含め、またそれに限定されない、いかなる保証もありません。著作権者もコントリビューターも、事由のいかんを問わず、 損害発生の原因いかんを問わず、かつ責任の根拠が契約であるか厳格責任であるか（過失その他の）不法行為であるかを問わず、仮にそのような損害が発生する可能性を知らされていたとしても、本ソフトウェアの使用によって発生した（代替品または代用サービスの調達、使用の喪失、データの喪失、利益の喪失、業務の中断も含め、またそれに限定されない）直接損害、間接損害、偶発的な損害、特別損害、懲罰的損害、または結果損害について、一切責任を負わないものとします。

EOF
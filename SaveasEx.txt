saveas_ex.txt

ファイル先頭の文字列をファイル名として、ファイル保存。
要するに、行頭からコメント行になっている行にある文字列のうち、ファイル先頭に最も近いファイルと思わしき文字列をファイル名として保存する。さらに...
TODO: カラーマーカーがあり、それが「ファイルと思わしき場所」と同じカラー表示のときは、その文字列をファイル名として用いる。
TODO: そういう文字列がないときは、ファイル先頭の文字列を利用する。連続する、ファイル名に使える最初の文字から、それに連続するファイル名に使える文字列(空白も含む)
それらの行のうち、shebang行を無視する。
ピリオド、スラッシュ、バックスラッシュを無視しないので、現フォルダからの相対位置で保存できる。
mount情報が使える。チルダでマイドキュメントとか。事前の準備が必要。
保存前に問い合わせてくれる。保存せずにファイル名を変更するだけということもできる。
TODO: デフォルトはダイアログも出さず現在のフォルダに現在の文字・改行コードで保存するが、ダイアログを出して現在の状態とは異なる設定で保存することも可能。（ダイアログを出すときは、田楽があると便利）


 shebang行とは :
1行目1文字目から( #! といったように)半角記号とその直後の半角 ! で始まっている行です。
shebang行らしきものがあれば、! 直前の文字列を、たとえコメント部分でなくてもコメント開始文字列と認識します。
本マクロでは、改名に利用する「ファイル名と思われる文字列」をコメント部分から探すのですが、
2行目以降がそのコメント文字と同じ文字列で始まっていたら、たとえコメント部分でなくても(そこにファイル名と思われる文字列があれば)その部分を利用します。
大切なことなので2回いいますが、同じ文字列で始まっていないとだめです。
この機能は、たとえば新規作成("ファイルタイプ別設定"が「共通」で、"複数行コメント"が「自動判定」や「なし」)...のような、コメントと見なされる部分が変更されやすい時に便利です。
なお、shebang行にある文字列は改名文字の対象とはなりません。

